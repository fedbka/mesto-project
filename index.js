(()=>{"use strict";var e="https://nomoreparties.co/v1/".concat("plus-cohort-15");function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var o=n((function e(t,n){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r(this,"_requestData",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r={method:t,headers:o._config.headers};return"GET"!=t&&n&&(r.body=JSON.stringify(n)),fetch("".concat(o._config.baseUrl,"/").concat(e),r).then((function(e){return e.ok?e.json():Promise.reject(e)}))})),r(this,"getInitialCards",(function(){return o._requestData("cards")})),r(this,"getProfile",(function(){return o._requestData("users/me")})),r(this,"updateProfile",(function(e,t){return o._requestData("users/me","PATCH",{name:e,about:t})})),r(this,"setLike",(function(e){return o._requestData("cards/likes/".concat(e),"PUT")})),r(this,"unsetLike",(function(e){return o._requestData("cards/likes/".concat(e),"DELETE")})),r(this,"removeCard",(function(e){return o._requestData("cards/".concat(e),"DELETE")})),r(this,"addCard",(function(e,t){return o._requestData("cards/","POST",{name:e,link:t})})),r(this,"updateAvatar",(function(e){return o._requestData("users/me/avatar","PATCH",{avatar:e})})),this._baseUrl=t,this._authorizationToken=n,this._config={baseUrl:t,headers:{authorization:n,"Content-Type":"application/json"}}}));function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a=function(){function e(t,n,r,o,i,a,c,l,s,f,p,m){var d=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),u(this,"_cardData",void 0),u(this,"_templateSelector",void 0),u(this,"_element",void 0),u(this,"_selectorCardElement",".element"),u(this,"_selectorCardImage",".element__image"),u(this,"_selectorCardTitle",".element__title"),u(this,"_selectorCardLikeButton",".element__like-button"),u(this,"_selectorCardDeleteButton",".element__delete-button"),u(this,"_selectorCardLikesCount",".element__likes-count"),u(this,"_cssClassCardLiked","element__like-button_liked"),u(this,"_cssClassCardDeleteButtonHidden","element__like-button_hidden"),u(this,"_imageClickHandler",void 0),u(this,"_checkInUserListHandler",void 0),u(this,"_checkOwnerHandler",void 0),u(this,"_addLikeHandler",void 0),u(this,"_removeLikeHandler",void 0),u(this,"_removeCardHandler",void 0),u(this,"_showErrorHandler",void 0),u(this,"_deleteConfirmHandler",void 0),u(this,"_closeDeleteConfirmAction",void 0),u(this,"_setConfirmButtonStateHandler",void 0),u(this,"_likeClickHandler",(function(){(d._cardLikeButton.classList.contains(d._cssClassCardLiked)?d._removeLikeHandler():d._addLikeHandler()).then((function(e){d._cardLikesCount.textContent=e.likes.length,d._cardLikeButton.classList.toggle(d._cssClassCardLiked)})).catch((function(e){return d._showErrorHandler(e)}))})),u(this,"_deleteCardHandler",(function(){d._deleteConfirmHandler((function(){d._setConfirmButtonStateHandler(),d._removeCardHandler(d._cardData._id).then((function(){d._element.remove(),d._closeDeleteConfirmAction()})).catch((function(e){return d._showErrorHandler(e)}))}))})),u(this,"_setEventListeners",(function(){d._cardImage.addEventListener("click",d._imageClickHandler),d._cardLikeButton.addEventListener("click",d._likeClickHandler),d._cardDeleteButton.addEventListener("click",d._deleteCardHandler)})),u(this,"getElement",(function(){return d._element=d._getCardElement(),d._cardImage=d._element.querySelector(d._selectorCardImage),d._cardImage.setAttribute("src",d._cardData.link),d._cardImage.setAttribute("alt",d._cardData.name),d._cardTitle=d._element.querySelector(d._selectorCardTitle),d._cardTitle.textContent=d._cardData.name,d._cardLikesCount=d._element.querySelector(d._selectorCardLikesCount),d._cardLikesCount.textContent=d._cardData.likes.length,d._cardLikeButton=d._element.querySelector(d._selectorCardLikeButton),d._owned=d._checkOwnerHandler(),d._isLiked=d._checkInUserListHandler(),d._cardDeleteButton=d._element.querySelector(d._selectorCardDeleteButton),d._owned&&d._cardDeleteButton.classList.remove(d._cssClassCardDeleteButtonHidden),d._isLiked&&d._cardLikeButton.classList.add(d._cssClassCardLiked),d._setEventListeners(),d._element})),this._templateSelector=n,this._cardData=t,this._imageClickHandler=r,this._checkInUserListHandler=o,this._checkOwnerHandler=i,this._addLikeHandler=a,this._removeLikeHandler=c,this._removeCardHandler=l,this._showErrorHandler=s,this._deleteConfirmHandler=f,this._closeDeleteConfirmAction=p,this._setConfirmButtonStateHandler=m}var t,n;return t=e,(n=[{key:"_getCardElement",value:function(){return document.querySelector(this._templateSelector).content.querySelector(this._selectorCardElement).cloneNode(!0)}}])&&i(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s=function(){function e(t,n){var r=t.items,o=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),l(this,"_items",void 0),l(this,"_renderer",void 0),l(this,"_selectorContainer",void 0),l(this,"_container",void 0),this._selectorContainer=n,this._container=document.querySelector(this._selectorContainer),this._items=r,this._renderer=o,this.renderItems()}var t,n;return t=e,n=[{key:"updateItems",value:function(e){this._items=e}},{key:"renderItem",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this._renderer(e);this.addItem(n,t)}},{key:"renderItems",value:function(){var e=this;this._items.forEach((function(t){return e.renderItem(t)}))}},{key:"addItem",value:function(e){arguments.length>1&&void 0!==arguments[1]&&!arguments[1]?this._container.prepend(e):this._container.append(e)}}],n&&c(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),p(this,"_cssClassShowPopup","popup_opened"),p(this,"_cssClassPopup","popup"),p(this,"_cssClassPopupCloseButton","popup__close-button"),p(this,"_handleEscClose",(function(e){"Escape"===e.key&&n._elementPopup.classList.contains(n._cssClassShowPopup)&&n.close()})),p(this,"_handleClickClose",(function(e){(e.target.classList.contains(n._cssClassPopup)||e.target.classList.contains(n._cssClassPopupCloseButton))&&n.close()})),this._selectorPopup=t,this._elementPopup=document.querySelector(this._selectorPopup)}var t,n;return t=e,(n=[{key:"open",value:function(){this.setEventListeners(),this._elementPopup.classList.add(this._cssClassShowPopup)}},{key:"close",value:function(){this.removeEventListeners(),this._elementPopup.classList.remove(this._cssClassShowPopup)}},{key:"setEventListeners",value:function(){this._elementPopup.addEventListener("mousedown",this._handleClickClose),document.addEventListener("keydown",this._handleEscClose)}},{key:"removeEventListeners",value:function(){this._elementPopup.removeEventListener("mousedown",this._handleClickClose),document.removeEventListener("keydown",this._handleEscClose)}}])&&f(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _(){return _="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=v(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},_.apply(this,arguments)}function y(e,t){return y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},y(e,t)}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var w=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=v(r);if(o){var n=v(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===d(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return b(e)}(this,e)});function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),g(b(t=i.call(this,e)),"_selectorImage",".showroom__image"),g(b(t),"_selectorCaption",".showroom__caption"),t._elementImage=t._elementPopup.querySelector(t._selectorImage),t._elementCaption=t._elementPopup.querySelector(t._selectorCaption),t}return t=u,(n=[{key:"open",value:function(e,t){this._elementImage.setAttribute("src",e),this._elementImage.setAttribute("alt",t),this._elementCaption.textContent=t,_(v(u.prototype),"open",this).call(this)}},{key:"close",value:function(){this._elementImage.setAttribute("src",""),this._elementImage.setAttribute("alt",""),this._elementCaption.textContent="",_(v(u.prototype),"close",this).call(this)}}])&&h(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(m);function P(e){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},P(e)}function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function k(){return k="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=S(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},k.apply(this,arguments)}function C(e,t){return C=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},C(e,t)}function E(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function S(e){return S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},S(e)}function j(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var L=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&C(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=S(r);if(o){var n=S(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===P(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return E(e)}(this,e)});function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),j(E(t=i.call(this,e)),"_selectorCaption",".popup__error"),j(E(t),"_handleSubmitPreventDefault",(function(e){return e.preventDefault()})),t._elementCaption=t._elementPopup.querySelector(t._selectorCaption),t}return t=u,(n=[{key:"open",value:function(e){this._elementCaption.textContent=e,console.log(e),k(S(u.prototype),"open",this).call(this)}},{key:"setEventListeners",value:function(){k(S(u.prototype),"setEventListeners",this).call(this),this._elementPopup.addEventListener("submit",this._handleSubmitPreventDefault)}},{key:"removeEventListeners",value:function(){this._elementPopup.removeEventListener("submit",this._handleSubmitPreventDefault),k(S(u.prototype),"removeEventListeners",this).call(this)}}])&&O(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(m);function I(e){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},I(e)}function D(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function B(){return B="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=q(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},B.apply(this,arguments)}function A(e,t){return A=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},A(e,t)}function H(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function q(e){return q=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},q(e)}function R(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var T=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&A(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=q(r);if(o){var n=q(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===I(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return H(e)}(this,e)});function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),R(H(t=i.call(this,e)),"_selectorFormSubmitButton",".form__submit-button"),R(H(t),"_buttonFormSubmit",void 0),R(H(t),"_textFormSubmitButton",""),R(H(t),"_handleSubmitPreventDefault",(function(e){return e.preventDefault()})),t._buttonFormSubmit=t._elementPopup.querySelector(t._selectorFormSubmitButton),t._textFormSubmitButton=t._buttonFormSubmit?t._buttonFormSubmit.textContent:"",t}return t=u,n=[{key:"renderLoading",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Отправляем...";this._buttonFormSubmit.textContent=e?t:this._textFormSubmitButton}},{key:"setEventListeners",value:function(){B(q(u.prototype),"setEventListeners",this).call(this),this._elementPopup.addEventListener("submit",this._handleSubmitPreventDefault)}},{key:"removeEventListeners",value:function(){this._elementPopup.removeEventListener("submit",this._handleSubmitPreventDefault),B(q(u.prototype),"removeEventListeners",this).call(this)}},{key:"open",value:function(e){this.renderLoading(!1),this._actionAfterConfirm=e,this._elementPopup.addEventListener("submit",this._actionAfterConfirm),B(q(u.prototype),"open",this).call(this)}},{key:"close",value:function(){this._elementPopup.removeEventListener("submit",this._actionAfterConfirm),B(q(u.prototype),"close",this).call(this)}}],n&&D(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(m);function F(e){return F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},F(e)}function x(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function U(){return U="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=W(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},U.apply(this,arguments)}function V(e,t){return V=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},V(e,t)}function M(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function W(e){return W=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},W(e)}function N(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var z=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&V(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=W(r);if(o){var n=W(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===F(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return M(e)}(this,e)});function u(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),N(M(n=i.call(this,e)),"_selectorFormSubmitButton",".form__submit-button"),N(M(n),"_buttonFormSubmit",void 0),N(M(n),"_textFormSubmitButton",""),n._form=n._elementPopup.querySelector(".form"),n._submitHandler=n._getSubmitHandler(t),n._buttonFormSubmit=n._elementPopup.querySelector(n._selectorFormSubmitButton),n._textFormSubmitButton=n._buttonFormSubmit?n._buttonFormSubmit.textContent:"",n}return t=u,n=[{key:"_getSubmitHandler",value:function(e){var t=this;return function(n){n.preventDefault(),t.renderLoading(!0),e(t._getInputValues()).then((function(){return t.close()})).finally((function(){return t.renderLoading(!1)}))}}},{key:"_getInputValues",value:function(){var e=this._form.elements,t=Array.from(e).map((function(e){return{name:e.name,value:"checkbox"===e.type?e.checked:e.value}})).filter((function(e){return!!e.name}));return new Map(t.map((function(e){return[e.name,e.value]})))}},{key:"_setInputValues",value:function(e){var t=this._form.elements;Array.from(t).map((function(t){var n=t.name,r=t.type;n&&e[n]&&(t.value="checkbox"===r?!!e[n]:e[n])}))}},{key:"renderLoading",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Отправляем...";this._buttonFormSubmit.textContent=e?t:this._textFormSubmitButton}},{key:"getFormElement",value:function(){return this._form}},{key:"setEventListeners",value:function(){U(W(u.prototype),"setEventListeners",this).call(this),this._form.addEventListener("submit",this._submitHandler)}},{key:"removeEventListeners",value:function(){this._form.removeEventListener("submit",this._submitHandler),U(W(u.prototype),"removeEventListeners",this).call(this)}},{key:"open",value:function(e){e&&this._setInputValues(e),U(W(u.prototype),"open",this).call(this)}},{key:"close",value:function(){this._form.reset(),U(W(u.prototype),"close",this).call(this)}}],n&&x(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(m);function G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function J(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var K=function(){function e(t){var n=t.selectorProfileUsername,r=t.selectorProfileDescription,o=t.selectorProfileAvatar;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),J(this,"_selectorProfileUsername",void 0),J(this,"_selectorProfileDescription",void 0),J(this,"_selectorProfileAvatar",void 0),J(this,"_elementUsername",void 0),J(this,"_elementDescription",void 0),J(this,"_elementAvatar",void 0),J(this,"_userInfo",{about:"",name:"",avatar:"",chohort:"",_id:""}),this._selectorProfileUsername=n,this._selectorProfileDescription=r,this._selectorProfileAvatar=o,this._getElements()}var t,n;return t=e,n=[{key:"_getElements",value:function(){this._elementUsername=document.querySelector(this._selectorProfileUsername),this._elementDescription=document.querySelector(this._selectorProfileDescription),this._elementAvatar=document.querySelector(this._selectorProfileAvatar)}},{key:"getUserInfo",value:function(){return this._userInfo}},{key:"setUserInfo",value:function(e){this._userInfo=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?G(Object(n),!0).forEach((function(t){J(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e),this._renderProfile()}},{key:"checkInUserList",value:function(e){var t=this;return e.some((function(e){return t.usersEqual(e)}))}},{key:"usersEqual",value:function(e){return this._userInfo._id==e._id}},{key:"_renderProfile",value:function(){this._elementUsername.textContent=this._userInfo.name,this._elementDescription.textContent=this._userInfo.about,this._elementAvatar.setAttribute("src",this._userInfo.avatar)}}],n&&$(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Q(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function X(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Z=function(){function e(t,n){var r,o=this,i=t.selectorInput,u=(t.selectorInputError,t.selectorSubmitButton);!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Y(this,"_cssFormItemWithError","form__item_invalid"),Y(this,"resetValidation",(function(){o._toggleFormButtonState(),o._inputsErrors.forEach((function(e,t){e.textContent="",t.classList.remove(o._cssFormItemWithError)}))})),Y(this,"_hasInvalidInput",(function(){return o._inputs.some((function(e){return!e.validity.valid}))})),Y(this,"_toggleFormButtonState",(function(){o._hasInvalidInput(o._inputs)?o._formSubmitButton.setAttribute("disabled",!0):o._formSubmitButton.removeAttribute("disabled",!1)})),Y(this,"_checkInputValidity",(function(e,t){e.validity.valid?(e.classList.remove(o._cssFormItemWithError),t.textContent=""):(e.setCustomValidity(e.validity.patternMismatch?e.dataset.errorMessage:""),e.classList.add(o._cssFormItemWithError),t.textContent=e.validationMessage)})),this._formElement=n,this._inputs=function(e){if(Array.isArray(e))return Q(e)}(r=this._formElement.querySelectorAll(i))||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(r)||function(e,t){if(e){if("string"==typeof e)return Q(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Q(e,t):void 0}}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),this._inputsErrors=new Map,this._inputs.forEach((function(e){var t=o._formElement.querySelector(".".concat(e.id,"-error"));o._inputsErrors.set(e,t)})),this._formSubmitButton=this._formElement.querySelector(u)}var t,n;return t=e,(n=[{key:"enableValidation",value:function(){var e=this;this._toggleFormButtonState(),this._inputs.forEach((function(t){return t.addEventListener("input",(function(){e._checkInputValidity(t,e._inputsErrors.get(t)),e._toggleFormButtonState()}))})),this._formElement.addEventListener("reset",(function(){return e._toggleFormButtonState()}))}}])&&X(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var te={selectorInput:".form__item",selectorInputError:".form__input-error",selectorSubmitButton:".form__submit-button"},ne=new o(e,"1eb95489-35af-40e1-aa20-3c2a6c828418"),re=new K({selectorProfileUsername:".profile__user-name",selectorProfileDescription:".profile__user-description",selectorProfileAvatar:".profile__avatar"}),oe=new w(".popup_with-image"),ie=new L(".popup_show-error"),ue=new T(".popup_confirm"),ae=new z(".popup_avatar-edit",(function(e){return ne.updateAvatar(e.get("avatarImageUrl")).then((function(e){return re.setUserInfo(e)})).catch((function(e){return ie.open(e)}))})),ce=new Z(te,ae.getFormElement());ce.enableValidation(),document.querySelector(".profile__avatar-button").addEventListener("click",(function(){ce.resetValidation(),ae.open()}));var le=new z(".popup_profile-edit",(function(e){return ne.updateProfile(e.get("name"),e.get("about")).then((function(e){return re.setUserInfo(e)})).catch((function(e){return ie.open(e)}))})),se=new Z(te,le.getFormElement());se.enableValidation(),document.querySelector(".profile__edit-button").addEventListener("click",(function(){se.resetValidation(),le.open(re.getUserInfo())}));var fe=new z(".popup_add-element",(function(e){return ne.addCard(e.get("elementName"),e.get("elementImageUrl")).then((function(e){return me.renderItem(e,!1)})).catch((function(e){return ie.open(e)}))})),pe=new Z(te,fe.getFormElement());pe.enableValidation(),document.querySelector(".profile__add-photo-button").addEventListener("click",(function(){pe.resetValidation(),fe.open()}));var me=new s({items:[],renderer:function(e){var t=function(e){return new a(e,"#element__template",(function(){return oe.open(e.link,e.name)}),(function(){return re.checkInUserList(e.likes)}),(function(){return re.usersEqual(e.owner)}),(function(){return ne.setLike(e._id)}),(function(){return ne.unsetLike(e._id)}),ne.removeCard,(function(e){return ie.open(e)}),(function(e){return ue.open(e)}),(function(){return ue.close()}),(function(){return ue.renderLoading(!0,"Удаляем...")}))}(e);return t.getElement()}},".elements");Promise.all([ne.getProfile(),ne.getInitialCards()]).then((function(e){var t,n,r=(n=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],u=!0,a=!1;try{for(n=n.call(e);!(u=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);u=!0);}catch(e){a=!0,o=e}finally{try{u||null==n.return||n.return()}finally{if(a)throw o}}return i}}(t,n)||function(e,t){if(e){if("string"==typeof e)return ee(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ee(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],i=r[1];re.setUserInfo(o),me.updateItems(i),me.renderItems()})).catch((function(e){return ie.open(e)}))})();